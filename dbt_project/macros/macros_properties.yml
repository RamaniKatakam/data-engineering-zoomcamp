macros:
  - name: get_trip_duration_minutes
    description: >
      Calculates trip duration in minutes from pickup and dropoff timestamps.
      This macro is cross-database compatible, supporting BigQuery.
      Returns a numeric value representing the duration in minutes.
    arguments:
      - name: pickup_datetime
        type: timestamp
        description: The pickup timestamp
      - name: dropoff_datetime
        type: timestamp
        description: The dropoff timestamp

  - name: get_vendor_data
    description: >
      Generates a CASE statement that maps vendor_id to vendor_name.
      This macro is cross-database compatible and generates SQL at compile time using a Jinja dictionary.
      Supports vendor IDs: 1 (Creative Mobile Technologies), 2 (VeriFone Inc.), 4 (Unknown/Other).
    arguments:
      - name: vendor_id_column
        type: integer
        description: The column name containing the vendor ID

  - name: safe_cast
    description: >
      This macro safely converts a column to a given data type. 
      It does it in the right way depending on which database youâ€™re using.
    arguments:
      - name: column
        description: The column name for which data type needs to be changed.
      - name: data_type
        description: Target data type

  - name: get_payment_type_description
    description: >
      Generates a CASE statement that returns type of payment for payment_id.
    arguments:
      - name: payment_type
        type: float
